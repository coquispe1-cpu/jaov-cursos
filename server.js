const express = require('express'); const app = express(); const stripe = require('stripe')('TU_SECRET_KEY_STRIPE'); const { google } = require('googleapis'); app.use(express.json()); app.use(express.static('public')); const sheets = google.sheets('v4'); const auth = new google.auth.GoogleAuth({ keyFile: 'credentials.json', scopes: ['https://www.googleapis.com/auth/spreadsheets'] }); const SPREADSHEET_ID = 'TU_ID_GOOGLE_SHEET'; app.post('/create-checkout-session', async (req,res)=>{ const { nombre, correo, curso, precio } = req.body; const client = await auth.getClient(); await sheets.spreadsheets.values.append({ auth: client, spreadsheetId: SPREADSHEET_ID, range: 'A:E', valueInputOption:'USER_ENTERED', requestBody:{values:[[nombre, correo, curso, precio, new Date().toLocaleString()]]} }); const session = await stripe.checkout.sessions.create({ payment_method_types:['card'], line_items:[{ price_data:{ currency:'usd', product_data:{name:curso}, unit_amount:precio*100 }, quantity:1 }], mode:'payment', success_url:'TU_DOMINIO/success.html', cancel_url:'TU_DOMINIO/cancel.html' }); res.json({url:session.url}); }); app.listen(3000, ()=>console.log('Servidor corriendo en puerto 3000'));